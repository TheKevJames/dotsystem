#!/usr/bin/env bash
set -euo pipefail

echo "Discovering files in need of backup..."

for folder in ".config/gcloud/configurations" ".config/nvim" ".config/tmuxifier/layouts" ".config/zsh/dropins" ".local/bin"; do
    # TODO: don't print when empty
    echo
    echo "The following files in ${folder} may be in need of backup:"
    # TODO: filter out expected:
    #   .local/bin/git-standup (and other src builds -> local bins)
    #   .config/zsh/dropins/osx.zsh (and other m4 -> dorpped extension)
    comm -23 \
        <(find ~/"${folder}" -mindepth 1 -type f | awk -F/ '{print $NF}' | sort -n) \
        <(find "./root/~/${folder}" -mindepth 1 -type f | awk -F/ '{print $NF}' | sort -n)
done
